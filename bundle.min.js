!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports["au-flux"]=e(require("react")):t["au-flux"]=e(t.React)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=5)}([function(t,e,r){"use strict";var n=r(1);class o{constructor(){this.globals={stores:{},defaultDispatcher:new n.a}}set(t,e){"stores"===t?this.initializeStores(e):this.globals[t]=e}get(t){return this.globals[t]}initializeStores(t){for(const e in t)t[e].setKey(e),this.globals.stores[e]=t[e]}}e.a=new o},function(t,e,r){"use strict";e.a=function(){const t={},e=[];let r=void 0;this.on=function(e,r){if(!e||!e.isStore)throw new Error("First argument must be a Store");if("string"!=typeof r)throw new Error('Second argument "action" must be a string');t.hasOwnProperty(r)||(t[r]=[]),t[r].push(e)},this.handleAction=function(e,r={}){return t.hasOwnProperty(e)&&t[e].length?Promise.all(t[e].map(t=>t.handleAction(e,r))).then(()=>Promise.resolve(!0)):Promise.reject(new Error(`There are no handlers for action "${e}"`))},this.trigger=function(t,o={}){return new Promise((s,i)=>{e.push({action:t,data:o,resolve:s,reject:i}),r||n()})};const n=function(){(r=e.shift())&&o(r)},o=({action:t,data:e,resolve:r,reject:o})=>{this.handleAction(t,e).then(t=>{r(t),n()}).catch(t=>{o(t),n()})}}},function(e,r){e.exports=t},function(t,e,r){"use strict";class n{constructor(){this.storeId=1,this.componentId=1}nextStoreId(){return this.storeId++}nextComponentId(){return this.componentId++}}e.a=new n},function(t,e,r){"use strict";var n=r(2),o=r.n(n);class s extends Error{constructor({message:t,key:e,recoverable:r}){super(t),this.key=e||"default",this.recoverable=r||void 0===r,this.name="StoreError"}}const i=(t,e,r)=>t&&t.key===e?o.a.createElement(r,{error:t}):null,a=s;e.a=a;e.b={StoreError:s,renderError:i}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),s=r(6),i=r(7),a=r(4);const c=o.a.get("defaultDispatcher");e.d=c;const u=n.a;e.Dispatcher=u;const h=o.a;e.globals=h;const l=a.b.renderError;e.renderError=l;const p=s.a;e.SmartComponent=p;const f=i.a;e.Store=f;const d=a.b.StoreError;e.StoreError=d},function(t,e,r){"use strict";var n=r(2),o=r.n(n),s=r(0),i=r(3),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};e.a={build(t,...e){const r=s.a.get("stores"),n=s.a.get("defaultDispatcher");class c extends o.a.Component{constructor(t){super(t),this.state={},this.key=i.a.nextComponentId();for(const t of e)r[t].connectToState(this.key,this.setState.bind(this)),this.state[t]=r[t].all()}componentWillUnmount(){for(const t of e)r[t].ignore(this.key)}render(){const e={},r={},s={};for(const t in this.state)e[t]=this.state[t].error,r[t]=this.state[t].loading,s[t]=this.state[t].value;return o.a.createElement(t,a({d:n},s,this.props))}}return c}}},function(t,e,r){"use strict";var n=r(3),o=r(0),s=r(4);const i=(t,e)=>{const r=e||o.a.get("defaultDispatcher"),i=n.a.nextStoreId(),a=[];let c=[],u=null;class h{constructor(e){this._componentListeners={},a.push({action:null,state:e}),this.isStore=!0;for(const e in t)r.on(this,e)}listen(t,e){if(this._componentListeners.hasOwnProperty(t))throw new Error(`component (key=${t}) is already listening to the store `+`(id=${i}, key=${u})`);this._componentListeners[t]=e}connectToState(t,e){return this.listen(t,t=>{const r={};r[this.key()||this.id()]=this.value(),e(r,t)}),this.value()}ignore(t){this._componentListeners.hasOwnProperty(t)&&delete this._componentListeners[t]}handleAction(e,r={}){if(!t[e])return Promise.reject(new s.a({message:`Store "${this.key()}" does not have an action "${e}"`}));let n=null;if("function"==typeof t[e]?n=t[e]:t[e].run&&"function"==typeof t[e].run&&(n=t[e].run),!n){const t=`Store "${this.key()}" does not have a run method for action "${e}"`;return Promise.reject(new s.a({message:t,recoverable:!1}))}const o={name:e,data:r};return n.call(this,r).then(t=>{t!==this.value()&&(a.push({action:o,state:t}),this.change(e),c=[])})}change(t){const e=Object.keys(this._componentListeners);return Promise.all(e.map(e=>new Promise((r,n)=>this._componentListeners[e].call(this,r,n,{action:t}))))}state(){return a.length?a[a.length-1].state:void 0}value(){return this.state()}setValue(t,e){e=e||"setValue",a.push({action:e,state:t}),this.change(e)}setKey(t){u=t}key(){return u}id(){return i}history(){return a}undo(){a.length<=1||(c.push(a.pop()),this.change("undo"))}redo(){c.length<1||(a.push(c.pop()),this.change("redo"))}}return h};e.a={build:i}}])});